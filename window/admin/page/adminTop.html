<!DOCTYPE html>
<html>
<!--
	ファイル名:adminPage.html
	概要　　　:管理者ページ
	作成日　　:2015.0612
	作成者　　:T.Masuda
	パス　　　:/adminPage.html
-->
<head>
<meta charset="UTF-8">
</head>
<body>
	<div id="container">
		<div class="main">
			<script>
				//ログインチェック用try-catch
				try{
					//カレントのウィンドウのDOMを取得する
					var $currentWindow = $(CURRENT_WINDOW);
					//カレントのウィンドウのコンテンツ領域を取得する
					var $currentContent = $(CURRENT_WINDOW_MAIN)
					
					var create_tag = new createLittleContents();	//管理者ページ用のcreateTagクラスインスタンスを生成する

					// ユーザーページのパーツのテンプレートのJSONを取得する。
					create_tag.getJsonFile('source/commonUser.json');
					// 管理者ページ共通のパーツのJSONを取得する。
					create_tag.getJsonFile('source/adminCommon.json');
					//共通のjsonを取得する
					create_tag.getJsonFile('source/commonJson.json');
	
					// ユーザーページのパーツのテンプレートのDOMを取得する。
					create_tag.getDomFile('template/commonUser.html');
					// 管理者ページ共通のパーツのJSONを取得する。
					create_tag.getDomFile('template/adminCommon.html');
					// 共通パーツのDOMを取得する
					create_tag.getDomFile('template/common.html');
					
					//パーツのHTMLを順次作成し、画面に追加していく
					//ユーザ情報のテキストをDBから取得する
					create_tag.getJsonFile('php/GetJSONString.php', create_tag.json['accountHeader'], 'accountHeader');
					//ヘッダー
					create_tag.outputTag('accountHeader', 'adminHeader', $currentContent);
					
					//タブ領域
					create_tag.outputTag('adminTab', 'tabContainer', $currentContent);
					//タブコンテンツ5個
					create_tag.outputTag('dayReserver','tabInContent', '.tabContentArea');
					create_tag.outputTag('lecturePermit','tabInContent', '.tabContentArea');
					create_tag.outputTag('userList','tabInContent', '.tabContentArea');
					create_tag.outputTag('lessonDetail','tabInContent', '.tabContentArea');
					create_tag.outputTag('mailMagaAndAnnounce','tabInContent', '.tabContentArea');
					
					//日ごと予約者一覧タブのコンテンツ
					//選択された日付を表示する領域
					create_tag.outputTag('dateBelt', 'dateBelt', '#dayReserver');
					//日付選択パーツのセット
					create_tag.outputTag('dateSelect', 'dateSelect', '#dayReserver');
					//日付ページングを実装する
					nowDatePaging('dateBelt', create_tag);
					//日ごと授業テーブルの外枠領域を作る
					create_tag.outputTag('eachDayReservedInfoTableOutsideArea', 'divArea', '#dayReserver');
					// 日ごと予約者一覧テーブル用のJSON配列を取得する
					create_tag.getJsonFile('php/GetJSONArray.php', create_tag.json['eachDayReservedInfoTable'], 'eachDayReservedInfoTable');
					//日ごと予約者の情報がないときにテーブルを作らない
					if(create_tag.json.eachDayReservedInfoTable[TABLE_DATA_KEY][0]) {
						//日ごと予約者一覧テーブルを作る
						create_tag.outputTagTable('eachDayReservedInfoTable','eachDayReservedInfoTable','#dayReserver');
						//管理者日ごと予約者一覧テーブルを置換する
						dbDataTableValueReplace(EACH_DAY_RESERVED_INFO_TABLE, EACH_DAY_RESERVED_INFO_TABLE_REPLACE_FUNC, true, create_tag);

					}
					//画面の先頭にスクロールを戻すボタン
					create_tag.outputTag('returnTopPosition', 'returnTopPosition', $currentContent);
					
					//タブを作る
					create_tag.createTab('.adminTab');
					//クリックでテキストボックスにカレンダーを表示する
					// clickCalendar('lesson_date');
	
					//受講承認タブをクリックしたときに受講承認の内容を表示する
					create_tag.createContentTriggerClick('.tabLink[href="#lecturePermit"]', createAdminPermitLessonContent);
					//ユーザ一覧タブをクリックしたときにユーザ一覧の内容を表示する
					create_tag.createContentTriggerClick('.tabLink[href="#userList"]', createAdminUserListContent);
					//授業詳細タブをクリックしたときに授業詳細の内容を表示する
					create_tag.createContentTriggerClick('.tabLink[href="#lessonDetail"]', createAdminLessonDetailContent, create_tag);
					//メルマガタブをクリックしたときにメルマガの内容を表示する
					create_tag.createContentTriggerClick('.tabLink[href="#mailMagaAndAnnounce"]', createAdminMailMagaAnnounceContent);
					// ボタンの見た目をjqueryuiのものにしてデザインを整える
					$('button, .searchButton, input[type="button"]').button();
					addlogoutEvent('.logoutLink');	//ログアウトボタンのイベントを登録する。
				}catch(e){
					console.log(e);
				}
			</script>
		</div>
	</div>
</body>
</html>