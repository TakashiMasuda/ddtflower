<!DOCTYPE html>
<html>
<head>
<!-- 画面の幅を使用している端末に依存する。加えてズームを許可しない。 -->
<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=yes">
<meta charset="UTF-8">
<title>DDTFlowers</title>
<!-- メインのCSSファイルを読み込む。 -->
<link href="css/style.css" rel="stylesheet" type="text/css">
<!-- 会員ページのcssを読み込む -->
<link href="css/memberPage.css" rel="stylesheet" type="text/css">
<!-- カレンダーのために体験ページのCSSファイルを読み込む。 -->
<link href="css/experience.css" rel="stylesheet" type="text/css">
<!-- jqueryUIのcssを読み込む -->
<link rel="stylesheet" type="text/css" href="css/jquery-ui-1.10.4.custom.min.css" media="screen" />
<!-- jQueryの本体を読み込む。 -->
<script src="js/jquery-1.11.0.min.js"></script>
<!-- jQueryUIを読み込む。 -->
<script type="text/javascript" src="js/jquery-ui-1.9.2.custom.min.js"></script>
<!-- タグを作成するJSの関数群を読み込む -->
<script type="text/javascript" src="js/createTag.js"></script>
<!-- easytabsの本体を読み込む。 -->
<script type="text/javascript" src="js/jquery.easytabs.js"></script>
<!-- 入力チェック機能のjQueryプラグイン -->
<script src="js/jquery.validate.min.js"></script>
<!-- validate.jsの日本語対応プラグイン -->
<script type="text/javascript" src="js/messages_ja.js"></script>
<!-- タッチ操作のライブラリ。 -->
<script src="js/jquery.finger.js"></script>
<!-- 画面操作の処理を記述したJSファイルを読み込む。 -->
<script type="text/javascript" src="js/controlPage.js"></script>
<!-- ダイアログ作成の処理を記述したJSファイルを読み込む。 -->
<script type="text/javascript" src="js/createDialog.js"></script>
<!-- 小規模のの処理を記述したJSファイルを読み込む。 -->
<script type="text/javascript" src="js/createLittleContent.js"></script>
<!-- ユーザのアクションに対応するイベントを定義したJSファイルを読み込む。 -->
<script type="text/javascript" src="js/controlAction.js"></script>
</head>
<body>
	<div id="container">
		<div class="main">
			<script>
			//ドキュメント配備後
			$(document).ready(function(){
				//ログインチェックして、NGであれば例外処理でログインダイアログを出すためのtry-catch
				try{
					hideNormalHeader();	//通常ページのヘッダーを隠す
					// dom要素を作るクラスをインスタンス化する
					var suggestionBoxCreator = new createTag();
					
					// 共通のパーツのJSONを取得する。
					suggestionBoxCreator.getJsonFile('source/memberCommon.json');
					// パスワード変更画面のjsonを読み込む
					suggestionBoxCreator.getJsonFile('source/memberSuggestionBox.json');
					//ユーザ情報のテキストをDBから取得する
					suggestionBoxCreator.getJsonFile('php/GetJSONString.php', suggestionBoxCreator.json['accountHeader'], 'accountHeader');
	
					// パーツのテンプレートのDOMを取得する。
					suggestionBoxCreator.getDomFile('template/common.html');
					//目安箱のテンプレートはmemberCommon.htmlに記述
					// パーツのテンプレートのDOMを取得する。
					suggestionBoxCreator.getDomFile('template/memberCommon.html');
					// 会員ページヘッダーを作る
					suggestionBoxCreator.outputTag('accountHeader', 'memberHeader');
					// バナー領域を作る
					suggestionBoxCreator.outputTag('userBanner');
					// お問い合わせ内容領域外側領域を作る
					suggestionBoxCreator.outputTag('suggestionArea', 'insertForm');
	
					//目安箱の店舗セレクトボックスを作る
					suggestionBoxCreator.outputTag('schoolNameSelectArea', 'schoolNameSelectArea', '.suggestionArea');
					//目安箱の種別セレクトボックスを作る
					suggestionBoxCreator.outputTag('suggestionTypeSelectArea', 'suggestionTypeSelectArea', '.suggestionArea');
					//目安箱のタイトル領域を作る
					suggestionBoxCreator.outputTag('labelTextboxArea', 'labelTextboxArea', '.suggestionArea');
	
					// お問い合わせ内容を入力する領域を作る
					suggestionBoxCreator.outputTag('textareaLabel', 'textareaLabel', '.suggestionArea');
					//目安箱か通常のメールかを決めるラジオボタンを作る
					suggestionBoxCreator.outputTag('radioArea', 'radioArea', '.suggestionArea');
					// 入力した内容を送信するボタンの領域を作る
					suggestionBoxCreator.outputTag('buttonArea', 'buttonArea', '.suggestionArea');
					//ボタンをjqueryのボタンにする
					$('input[type="button"], input[type="reset"]').button();
					//送信ボタンがクリックされた時、入力されているデータを取得してDBを更新し、メールを送信する
					$(STR_BODY).on(CLICK, '.button1', function() {
						var doIt = function (){
							//入力されているデータを取得しクエリを挿入するための値として扱う
							var sendData = getInputData('suggestionArea');
							//クエリに送信するデータに会員番号を加える
							sendData['user_key'] = suggestionBoxCreator.json.memberHeader.user_key.value;
							//目安箱にチェックが入っていればDBの値を更新するクエリを発行する
							if($('[name="suggestionRadio"]').val() == "0") {
								//目安箱テーブルに新たにデータを挿入する
								setDBdata(suggestionBoxCreator.json.insertSuggestionBox, sendData, '');
								//目安箱としてメールを送信する
								//メール送信処理
							//目安箱でないなら
							} else {
								//通常メールとして送信する
							}
						};
						var sd = new SimpleConfirmDialog(
								function(){
										doIt;
								},
								"送信します。よろしいですか?");
						sd._showDialog();
					});
					addlogoutEvent('.logoutLink');	//ログアウトボタンのイベントを登録する。
				} catch(e) {
					console.log(e)
				}
			});
			</script>
		</div>
	</div>
</body>
</html>