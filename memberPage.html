<!DOCTYPE html>
<html>
<head>
<!-- 画面の幅を使用している端末に依存する。加えてズームを許可しない。 -->
<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=yes">
<meta charset="UTF-8">
<title>DDTFlowers</title>
<!-- メインのCSSファイルを読み込む。 -->
<link href="css/style.css" rel="stylesheet" type="text/css">
<!-- 会員ページのcssを読み込む -->
<link href="css/memberPage.css" rel="stylesheet" type="text/css">
<!-- jqueryUIのcssを読み込む -->
<link rel="stylesheet" type="text/css" href="css/jquery-ui-1.10.4.custom.min.css" media="screen" />
<!-- jQueryの本体を読み込む。 -->
<script src="js/jquery-1.11.0.min.js"></script>
<!-- jQueryUIを読み込む。 -->
<script type="text/javascript" src="js/jquery-ui-1.9.2.custom.min.js"></script>
<!-- タグを作成するJSの関数群を読み込む -->
<script type="text/javascript" src="js/createTag.js"></script>
<!-- easytabsの本体を読み込む。 -->
<script type="text/javascript" src="js/jquery.easytabs.js"></script>
<!-- 入力チェック機能のjQueryプラグイン -->
<script src="js/jquery.validate.min.js"></script>
<!-- validate.jsの日本語対応プラグイン -->
<script type="text/javascript" src="js/messages_ja.js"></script>
<!-- タッチ操作のライブラリ。 -->
<script src="js/jquery.finger.js"></script>
<!-- 画面操作の処理を記述したJSファイルを読み込む。 -->
<script type="text/javascript" src="js/controlPage.js"></script>
<!-- ダイアログ作成の処理を記述したJSファイルを読み込む。 -->
<script type="text/javascript" src="js/createDialog.js"></script>
<!-- 小規模のの処理を記述したJSファイルを読み込む。 -->
<script type="text/javascript" src="js/createLittleContent.js"></script>
<!-- ユーザのアクションに対応するイベントを定義したJSファイルを読み込む。 -->
<script type="text/javascript" src="js/controlAction.js"></script>
<!-- ユーザのアクションに対応するイベントを定義したJSファイルを読み込む。 -->
<script type="text/javascript" src="js/dailyClasses.js"></script>
</head>
<body>
	<div id="container">
		<div class="main">
			<script>
			//ドキュメント配備後
			$(document).ready(function(){
				//変更者:T.Yamamoto 指示者H.Kaneko 内容:creatorが重複するため、コメントにしました。
				//creator = new createTag();
				//creator.getJsonFile('source/memberPage.json');
				//// 会員共通のパーツのJSONを取得する。
				//creator.getJsonFile('source/memberCommon.json');
				//パーツのテンプレートのDOMを取得する。
				creator.getDomFile('template/common.html');
				// 会員共通のパーツのJSONを取得する。
				creator.getDomFile('template/memberCommon.html');
				// 会員ページのjsonを読み込む
				creator.getDomFile('template/memberPage.html');
				//ユーザ情報のテキストをDBから取得する
				creator.getJsonFile('php/GetJSONString.php', creator.json['memberHeader'], 'memberHeader');

				// 会員ページヘッダーを作る
				creator.outputTag('memberHeader');
				// バナー領域を作る
				creator.outputTag('userBanner');
				//告知領域のテキストをDBから取得する
				creator.getJsonFile('php/GetJSONString.php', creator.json['advertise'], 'advertise');
				// 告知領域を作る
				creator.outputTag('advertise');
				//通知領域の内容があれば
				if($('.advertise p:not(:empty)').length){
					$('.advertise').show();		//通知領域を表示する
				}
				// 会員ページのカレンダーを作る
				creator.outputTag('lessonCalendar', 'calendar');

				// タブ機能を作る
				creator.outputTag('lessonTab');
				// 予約済み授業のタブ内コンテンツを作る
				creator.outputTag('alreadyReserved', 'tabInContent', '.tabContentArea');
				// 受講済み授業のタブ内コンテンツを作る
				creator.outputTag('finishedLesson', 'tabInContent', '.tabContentArea');

				// 予約済み授業と受講済み授業についてタブを作る
				createTab('#tab-container');

				// 日ごと授業のjsonを読み込む
				creator.getJsonFile('source/eachDayLesson.json');
				// 日ごと授業のテンプレートを読み込む
				creator.getDomFile('template/eachDayLesson.html');

				//予約一覧ダイアログを作る
				var lessonList = new tagDialog('reserveLessonListDialog', '', dialogOption['reserveLessonListDialog'], function(){
					// 日ごとダイアログ領域を作る
					creator.outputTag('reserveLessonListDialog', 'dialog', 'body');
				// テーブルのステータスを概要を表示する領域を作る
				// creator.outputTag('lessonStatus', 'lessonStatus', '.memberInfomation');
				// 予約一覧テーブルの値を置換する
				// lessonTableValueInput('.lessonTable', eachDayLessonTable, "callReservedLessonValue");
				});

				//予約確定ダイアログを作る
				var confirmReserveLesson = new tagDialog(STR_MEMBER_RESERVED_CONFIRM_DIALOG, '', dialogOption[STR_MEMBER_RESERVED_CONFIRM_DIALOG], function(){
					// テーブルのステータスを概要を表示する領域を作る
					creator.outputTag(STR_MEMBER_RESERVED_CONFIRM_DIALOG, STR_MEMBER_RESERVED_CONFIRM_DIALOG,  STR_BODY);
				});
				// カレンダーを作り、クリックでダイアログ作成を作る
				var memCalendar = new memberCalendar('.lessonCalendar', 90, 117, lessonList);
				memCalendar.create();	//カレンダーを実際に作成する

				//予約中授業テーブル用のJSON配列を取得する
				creator.getJsonFile('php/GetJSONArray.php', creator.json['lessonReservedDetailTable'], 'lessonReservedDetailTable');
				//予約中の授業があった時のテーブルを作る
				if(creator.json['lessonReservedDetailTable']['table'] !== void(0)) {
					// 予約中授業のテーブルを作る
					creator.outputTagTable('lessonReservedDetailTable','reservedLessonTable','.alreadyReserved');
				}
				//受講済み授業テーブル用のJSON配列を取得する
				creator.getJsonFile('php/GetJSONArray.php', creator.json['lessonFinishedDetailTable'], 'lessonFinishedDetailTable');
				//受講済みの授業があったときテーブルを作る
				if(creator.json['lessonFinishedDetailTable']['table'] !== void(0)) {
					//受講済み授業テーブルを作る
					creator.outputTagTable('lessonFinishedDetailTable','finishedLessonTable','.finishedLesson');
				}
				//注釈を作る
				creator.outputTag('anotion', 'anotion', '.tabPanel');
				
				// 絞り込みボタンをjqueryのボタンにする
				$('.selectThemeButton').button();
				//
				lessonThemeSearch();

 				// 予約中授業の連想配列を変数に入れる 
				var reservedNow = creator.json['lessonReservedDetailTable']['table'];
				// 受講済みの連想配列を変数に入れる
				var lessonFinished = creator.json['lessonFinishedDetailTable']['table'];
				// 日ごと授業テーブルの連想配列を変数に入れる
				var eachDayLessonTable = creator.json['memberTable']['table'];
				// 予約中テーブルのテーブルの値をしかるべき値にする
				lessonTableValueInput('.reservedLessonTable', reservedNow, "callMemberLessonValue");
				// 受講済みテーブルのテーブルの値をしかるべき値にする
				lessonTableValueInput('.finishedLessonTable', lessonFinished, "callMemberLessonValue");
			});
			</script>
		</div>
	</div>
</body>
</html>
